var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,a=Object.getOwnPropertySymbols,n=Object.prototype.propertyIsEnumerable,r=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,l=(e,l)=>{for(var o in l||(l={}))t.call(l,o)&&r(e,o,l[o]);if(a)for(var o of a(l))n.call(l,o)&&r(e,o,l[o]);return e};import"./dynamic-import-polyfill.301f8c0f.js";import{D as o,c as m,a as c}from"./vendor.de0aed71.js";function s(e){const{tablePage:t,tablePageDispatch:a}=e,{minimumYear:n,maximumYear:r}=o.useContext(h),l=o.useMemo((()=>{const e=[];for(let t=n;t<=r;++t)e.push(o.createElement("option",{value:t,key:`option-${t}`},t));return e}),[r,n]),m=o.useMemo((()=>{const e=[];for(let t=1;t<=12;++t)e.push(o.createElement("option",{value:t-1,key:`option-${t}`},t));return e}),[]);return o.createElement("div",{className:"date-navigator"},o.createElement("button",{className:"last-year-button",onClick:()=>a({type:"add",payload:{yearIncrement:-1}}),disabled:t.year<=n}),o.createElement("button",{className:"last-month-button",onClick:()=>a({type:"add",payload:{monthIncrement:-1}}),disabled:t.year<=n&&0===t.month}),o.createElement("select",{className:"year-select",name:"year",id:"year",value:t.year,onChange:e=>a({type:"set",payload:{year:parseInt(e.target.value),month:t.month}})},l),o.createElement("select",{className:"month-select",name:"month",id:"month",value:t.month,onChange:e=>a({type:"set",payload:{year:t.year,month:parseInt(e.target.value)}})},m),o.createElement("button",{className:"next-month-button",onClick:()=>a({type:"add",payload:{monthIncrement:1}}),disabled:t.year>=r&&11===t.month}),o.createElement("button",{className:"next-year-button",onClick:()=>a({type:"add",payload:{yearIncrement:1}}),disabled:t.year>=r}))}function u(e){const t=12*e.year+e.month;return t<=0?{year:Math.floor(t/12),month:t%12+12}:{year:Math.floor(t/12),month:t%12}}function i(e,t){return[31,28,31,30,31,30,31,31,30,31,30,31][t]+(1===t&&(e%4==0&&e%100!=0||e%400==0)?1:0)}function d(e){const{tablePage:{year:t,month:a}}=e,{mode:n,date:r,prevDate:l,setDate:c,minimumYear:s,maximumYear:d,maxDayRange:y}=o.useContext(h),g=o.useMemo((()=>function(e,t){const a=i(e,t),n=u({year:e,month:t-1}),r=u({year:e,month:t+1}),l=i(n.year,n.month),o=(new Date(e,t).getDay()+6)%7;let m=1,c=1;return Array.from(Array(6),((s,u)=>{if(s=Array(7),0===u){let a=0;for(;a<o;++a)s[a]=new Date(n.year,n.month,l-o+a+1);for(;a<7;++a,m++)s[a]=new Date(e,t,m)}else{let n=0;for(;n<7&&m<=a;++n,++m)s[n]=new Date(e,t,m);for(;n<7;++n,++c)s[n]=new Date(r.year,r.month,c)}return s}))}(t,a)),[a,t]),p=o.useRef(null);o.useEffect((()=>{p.current&&p.current.focus()}),[t,a]);const f=o.useCallback((e=>{switch(n){case"single":return()=>{c(e)};case"range":return()=>{var t;Math.floor(Math.abs((null!=(t=null==r?void 0:r.getTime())?t:1/0)-e.getTime()))/864e5>y?c(e,null):c(e,r)}}}),[r,y,n,c]);return o.createElement("table",{className:"date-table"},o.createElement("thead",null,o.createElement("tr",null,o.createElement("th",null,"Mo"),o.createElement("th",null,"Tu"),o.createElement("th",null,"We"),o.createElement("th",null,"Th"),o.createElement("th",null,"Fr"),o.createElement("th",null,"Sa"),o.createElement("th",null,"Su"))),o.createElement("tbody",null,g.map(((e,c)=>o.createElement("tr",{key:`${t}-${a}-${c}`},e.map(((e,u)=>{const i=e.getFullYear(),y=e.getMonth(),g=e.getTime();return i<s||i>d?o.createElement("td",{className:"empty-cell"}):o.createElement("td",{tabIndex:0,key:`${t}-${a}-${c}-${u}`,onClick:f(e),className:m({"selected-cell":(null==r?void 0:r.getTime())===g||"range"===n&&(null==l?void 0:l.getTime())===g},{"in-current-month":y===a},{"in-range-cell":r&&l&&(g-r.getTime())*(g-l.getTime())<0}),ref:(null==r?void 0:r.getTime())==g?p:void 0},e.getDate())})))))))}function y(e){return{year:e.getFullYear(),month:e.getMonth()}}function g(){const e=o.useCallback(((e,t)=>{switch(t.type){case"set":return u(t.payload);case"add":{const{yearIncrement:a=0,monthIncrement:n=0}=t.payload;return u({year:e.year+a,month:e.month+n})}}}),[]),{date:t}=o.useContext(h),[a,n]=o.useReducer(e,y(null!=t?t:new Date));return o.useEffect((()=>{t&&n({type:"set",payload:y(t)})}),[t]),o.createElement("div",{className:"date-picker-widget"},o.createElement(s,{tablePage:a,tablePageDispatch:n}),o.createElement(d,{tablePage:a}))}const h=o.createContext(void 0);function p(e){const{mode:r="single",maxDayRange:m=300,dateText:c,setDateText:s,minimumYear:u=1900,maximumYear:i=2200}=e,d=((e,r)=>{var l={};for(var o in e)t.call(e,o)&&r.indexOf(o)<0&&(l[o]=e[o]);if(null!=e&&a)for(var o of a(e))r.indexOf(o)<0&&n.call(e,o)&&(l[o]=e[o]);return l})(e,["mode","maxDayRange","dateText","setDateText","minimumYear","maximumYear"]),[y,p]=o.useState(isNaN(Date.parse(c))?null:new Date(c)),[f,E]=o.useState(null),b=o.useMemo((()=>{switch(r){case"single":return p;case"range":return(e,t)=>{void 0!==t&&E(t),p(e)}}throw new Error("Mode unspecified.")}),[r]),v=o.useCallback((e=>{switch(r){case"single":if(isNaN(Date.parse(e)))p(null);else{const t=new Date(e),a=t.getFullYear();a>=u&&a<=i&&(t.setHours(0,0,0,0),p(t))}break;case"range":{const t=e.split(/\s*,\s*/);if(2===t.length&&t.every((e=>!isNaN(Date.parse(e))))){const[e,a]=t.map((e=>new Date(e)));if(Math.floor(Math.abs(e.getTime()-a.getTime())/864e5)<=m){E(e),p(a);break}}E(null),p(null);break}}}),[m,i,u,r]);return o.useEffect((()=>{if(y)if(f){const[e,t]=[f.getTime(),y.getTime()],[a,n]=[e<t?f:y,e<t?y:f];s(`${a.toLocaleDateString()}, ${n.toLocaleDateString()}`)}else s(y.toLocaleDateString());else s("")}),[y,f,s]),o.createElement(h.Provider,{value:{mode:r,date:y,setDate:b,minimumYear:u,maximumYear:i,prevDate:f,maxDayRange:m}},o.createElement("div",{className:"date-picker"},o.createElement("input",l(l({},d),{className:"date-picker-text-input",type:"text",value:c,onChange:e=>s(e.target.value),onBlur:e=>v(e.target.value)})),o.createElement(g,null)))}function f(){const[e,t]=o.useState(""),[a,n]=o.useState("");return o.createElement("div",null,o.createElement("label",{htmlFor:"date"},"单日期选择"),o.createElement(p,{id:"single-picker",name:"date",mode:"single",dateText:e,setDateText:t,minimumYear:1900,maximumYear:2100}),o.createElement("label",{htmlFor:"range-picker"},"日期范围选择"),o.createElement(p,{id:"range-picker",name:"date-range",mode:"range",dateText:a,setDateText:n}))}c.render(o.createElement(f,null),document.getElementById("root"));
